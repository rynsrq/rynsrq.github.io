<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Reading Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#2f2418; --surface:#231a12; --panel:#3b3026; --muted:#b8a995; --accent:#f6c9d2; --accent-strong:#f5b7c6; --white:#fff6f6; --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;background:var(--bg);color:var(--white);-webkit-font-smoothing:antialiased}
    .app{max-width:540px;margin:0 auto;padding:18px 14px 96px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    header h1{font-size:26px;margin:0;font-weight:700}
    header .sub{font-size:12px;color:var(--muted)}/* Session list */
.list{display:flex;flex-direction:column;gap:12px;margin-top:10px}
.session{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-radius:14px;min-height:56px}
.session.pink{background:linear-gradient(90deg,var(--accent) 0%, var(--accent-strong) 100%); color:#241916}
.session.brown{background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); color:var(--white)}
.session .left{display:flex;gap:12px;align-items:center}
.session .time-s{font-weight:700;font-size:16px}
.session .dur{font-size:14px}

/* FAB */
.fab{position:fixed;right:18px;bottom:100px;background:var(--accent);color:#241916;padding:14px 20px;border-radius:28px;box-shadow:0 10px 30px rgba(0,0,0,0.4);display:flex;gap:10px;align-items:center;font-weight:700;border:0}

/* Calendar */
.month-title{font-size:20px;margin:20px 0 8px}
.weekdays{display:flex;gap:6px;color:var(--muted);margin-bottom:8px}
.weekdays div{flex:1;text-align:center;font-size:12px}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.circle-day{width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.03);color:var(--muted);margin:auto;font-weight:600}
.circle-day.today{outline:3px solid rgba(245,183,198,0.18);}
.month-block{margin-bottom:24px}
.month-label{font-size:20px;margin:6px 0;color:var(--white)}

/* Year box */
.months-row{display:flex;gap:8px;overflow:auto;padding:8px 4px}
.month-box{min-width:90px;padding:10px;border-radius:12px;background:var(--panel);text-align:center}

/* Configs */
.section{background:var(--panel);padding:12px;border-radius:12px;margin-top:12px}
.section h3{margin:0 0 10px 0;color:var(--white)}
.row{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:rgba(255,255,255,0.02);margin-bottom:8px}
.row .label{display:flex;gap:12px;align-items:center}
.row small{color:var(--muted)}

/* Bottom nav */
.bottom-nav{position:fixed;left:0;right:0;bottom:0;height:76px;background:#3b2f24;display:flex;gap:8px;align-items:center;justify-content:space-around;padding:10px}
.nav-item{flex:1;text-align:center;color:var(--muted);font-weight:600}
.nav-item.active{background:#2a2118;padding:10px;border-radius:18px;color:var(--white)}

/* Small screens */
@media (max-width:420px){.app{padding:14px 12px 110px}.circle-day{width:40px;height:40px}}

/* utility */
.muted{color:var(--muted)}
.center{display:flex;align-items:center;justify-content:center}

  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div>
        <h1 id="pageTitle">Home</h1>
        <div class="sub" id="subTitle">Today</div>
      </div>
      <div class="sub" id="clock">--:--</div>
    </header><!-- HOME -->
<main id="homeView">
  <div class="list" id="sessionList"></div>
  <div style="margin-top:8px;display:flex;gap:8px">
    <div style="flex:1;background:rgba(255,255,255,0.02);padding:10px;border-radius:12px;text-align:center">Today<br><strong id="sumToday">0h 0m</strong></div>
    <div style="flex:1;background:rgba(255,255,255,0.02);padding:10px;border-radius:12px;text-align:center">This Week<br><strong id="sumWeek">0h 0m</strong></div>
    <div style="flex:1;background:rgba(255,255,255,0.02);padding:10px;border-radius:12px;text-align:center">Month<br><strong id="sumMonth">0h 0m</strong></div>
  </div>
</main>

<!-- CALENDAR -->
<main id="calendarView" style="display:none">
  <div class="month-block">
    <div class="month-label" id="monthTitle">Month</div>
    <div class="weekdays"><div>M</div><div>T</div><div>W</div><div>T</div><div>F</div><div>S</div><div>S</div></div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </div>
  <div class="month-block" style="margin-top:6px">
    <div class="month-label">Last 12 months</div>
    <div class="months-row" id="monthsList"></div>
  </div>
</main>

<!-- CONFIG -->
<main id="configView" style="display:none">
  <div class="section">
    <h3>Categories</h3>
    <div class="row"><div class="label"><div>ðŸ’»</div><div><strong>STUDY</strong></div></div><div>â€º</div></div>
    <div style="text-align:center;margin:10px 0"><button id="addCategoryBtn" style="background:#71593f;color:var(--white);padding:10px 16px;border-radius:12px;border:0">+ add category</button></div>
  </div>

  <div class="section">
    <h3>Analytics</h3>
    <div class="row"><div><strong>Crash reports</strong><br><small>Ask to send crash reports</small></div><div><input id="crashToggle" type="checkbox"></div></div>
    <div class="row"><div><strong>System logs</strong><br><small>Include system logs in crash reports</small></div><div><input id="logsToggle" type="checkbox"></div></div>
  </div>

  <div class="section">
    <h3>Storage</h3>
    <div class="row"><div><strong>Backup</strong><br><small>Export a backup file of your sessions</small></div><div><button id="exportBtn">Export</button></div></div>
    <div class="row"><div><strong>Import</strong><br><small>Load sessions from a backup JSON</small></div><div><input id="importFile" type="file" accept="application/json"></div></div>
  </div>
</main>

<button class="fab" id="startBtn"><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M5 3v18l15-9L5 3z"/></svg> Start</button>

  </div>  <div class="bottom-nav">
    <div class="nav-item active" id="navHome">Home</div>
    <div class="nav-item" id="navCalendar">Calendar</div>
    <div class="nav-item" id="navConfig">Configurations</div>
  </div>  <script>
    // Full functional app: stopwatch, save sessions, calendar, summaries, export/import
    const STORAGE_KEY='reading_sessions_v1';

    function loadData(){ try{ const raw=localStorage.getItem(STORAGE_KEY); return raw?JSON.parse(raw):{} }catch(e){return{}} }
    function saveData(d){ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)) }

    // Stopwatch state
    let running=false, startTs=null, timerId=null;

    const startBtn=document.getElementById('startBtn');
    const sessionList=document.getElementById('sessionList');
    const sumTodayEl=document.getElementById('sumToday');
    const sumWeekEl=document.getElementById('sumWeek');
    const sumMonthEl=document.getElementById('sumMonth');
    const calendarGrid=document.getElementById('calendarGrid');
    const monthTitle=document.getElementById('monthTitle');
    const monthsList=document.getElementById('monthsList');

    // Format helpers
    function fmtTime(iso){ const d=new Date(iso); return d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}); }
    function pad(n){ return String(n).padStart(2,'0') }
    function secsToHMS(total){ total=Math.floor(total); const h=Math.floor(total/3600); const m=Math.floor((total%3600)/60); const s=total%60; return `${pad(h)}:${pad(m)}:${pad(s)}` }
    function shortHours(total){ if(!total) return '0h 0m'; const h=Math.floor(total/3600); const m=Math.floor((total%3600)/60); return `${h}h ${m}m` }

    // Save session
    function saveSession(start, end){ const data=loadData(); const startDate=new Date(start); const key=startDate.toISOString().slice(0,10); if(!data[key]) data[key]=[]; const secs=Math.floor((new Date(end)-new Date(start))/1000); data[key].push({start:new Date(start).toISOString(), end:new Date(end).toISOString(), secs}); saveData(data); renderHome(); renderCalendar(currentYear, currentMonth); renderMonths(); }

    // Start/Stop logic
    startBtn.addEventListener('click', ()=>{
      if(!running){ running=true; startTs=Date.now(); startBtn.textContent='Stop'; startBtn.style.background='#eb9aa7'; timerId=setInterval(()=>{ updateFab(); },300); }
      else { // stop -> save session
        running=false; clearInterval(timerId); startBtn.textContent='Start'; startBtn.style.background='var(--accent)'; const end=Date.now(); saveSession(startTs, end); startTs=null; updateFab(); }
    });

    function updateFab(){ if(running && startTs){ const secs=Math.floor((Date.now()-startTs)/1000); startBtn.innerHTML=`<svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M10 8h4v8h-4z"/></svg> ${secsToHMS(secs)}` } else { startBtn.innerHTML=`<svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M5 3v18l15-9L5 3z"/></svg> Start` } }

    // Render home list
    function renderHome(){ const data=loadData(); const todayKey=new Date().toISOString().slice(0,10); const arr=data[todayKey]||[]; sessionList.innerHTML='';
      // show in reverse (recent first)
      arr.slice().reverse().forEach((s,idx)=>{
        const el=document.createElement('div'); el.className='session '+((idx%2)?'brown':'pink');
        el.innerHTML=`<div class="left"><div class="time-s">${fmtTime(s.start)}</div><div class="dur">â”€â”€ ${Math.round(s.secs/60)} min â”€â”€</div></div><div class="right">${fmtTime(s.end)}</div>`;
        sessionList.appendChild(el);
      });
      // summaries
      const todaySecs=(data[todayKey]||[]).reduce((a,b)=>a+b.secs,0); sumTodayEl.textContent = shortHours(todaySecs);

      // week
      const startW = startOfWeek(new Date()); let weekSecs=0; for(let i=0;i<7;i++){ const d=new Date(startW); d.setDate(startW.getDate()+i); const key=d.toISOString().slice(0,10); (data[key]||[]).forEach(s=>weekSecs+=s.secs); } sumWeekEl.textContent = shortHours(weekSecs);

      // month
      const now=new Date(); const y=now.getFullYear(), m=now.getMonth(); let monthSecs=0; const mdays=new Date(y,m+1,0).getDate(); for(let d=1; d<=mdays; d++) monthSecs+= sumSecondsForDate(data,y,m,d); sumMonthEl.textContent = shortHours(monthSecs);
    }

    // Calendar rendering
    let currentYear=(new Date()).getFullYear(), currentMonth=(new Date()).getMonth();
    function startOfWeek(d){ const dd=new Date(d); const day=dd.getDay(); const diff = dd.getDate() - day + (day===0?-6:1); dd.setDate(diff); dd.setHours(0,0,0,0); return dd }
    function sumSecondsForDate(data,y,m,d){ const key = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`; const arr = data[key]||[]; return arr.reduce((s,sess)=>s + (sess.secs||0),0) }

    function renderCalendar(year, month){ calendarGrid.innerHTML=''; monthTitle.textContent = new Date(year,month,1).toLocaleString(undefined,{month:'long',year:'numeric'});
      const first=new Date(year,month,1); const leading=(first.getDay()+6)%7; const daysInMonth=new Date(year,month+1,0).getDate(); const total = leading + daysInMonth; const rows=Math.ceil(total/7);
      const data=loadData();
      for(let i=0;i<leading;i++){ const cell=document.createElement('div'); cell.innerHTML=''; calendarGrid.appendChild(cell); }
      for(let d=1; d<=daysInMonth; d++){ const cell=document.createElement('div'); const circle=document.createElement('div'); circle.className='circle-day'; circle.textContent=d; const secs = sumSecondsForDate(data,year,month,d); if(secs>0) circle.style.background='rgba(245,183,198,0.12)'; const cellDateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`; const todayStr = new Date().toISOString().slice(0,10); if(cellDateStr===todayStr) circle.classList.add('today'); circle.addEventListener('click', ()=>{ alert(`${cellDateStr}: ${shortHours(secs)}`) }); cell.appendChild(circle); calendarGrid.appendChild(cell); }
      const trailing = rows*7 - total; for(let j=0;j<trailing;j++){ const cell=document.createElement('div'); cell.innerHTML=''; calendarGrid.appendChild(cell); }
    }

    // months strip
    function renderMonths(){ monthsList.innerHTML=''; const data=loadData(); for(let i=11;i>=0;i--){ const dt=new Date(); dt.setMonth(dt.getMonth()-i); const y=dt.getFullYear(), m=dt.getMonth(); let msecs=0; const mdays=new Date(y,m+1,0).getDate(); for(let d=1; d<=mdays; d++) msecs += sumSecondsForDate(data,y,m,d); const box=document.createElement('div'); box.className='month-box'; box.innerHTML=`<div style="font-size:12px">${dt.toLocaleString(undefined,{month:'short',year:'numeric'})}</div><div style="font-weight:700;margin-top:6px">${shortHours(msecs)}</div>`; monthsList.appendChild(box); } }

    // nav
    const navHome=document.getElementById('navHome'), navCalendar=document.getElementById('navCalendar'), navConfig=document.getElementById('navConfig');
    const homeView=document.getElementById('homeView'), calendarView=document.getElementById('calendarView'), configView=document.getElementById('configView');
    function setActive(el){ document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active')); el.classList.add('active'); }
    navHome.addEventListener('click', ()=>{ setActive(navHome); homeView.style.display='block'; calendarView.style.display='none'; configView.style.display='none'; document.getElementById('pageTitle').textContent='Home'; });
    navCalendar.addEventListener('click', ()=>{ setActive(navCalendar); homeView.style.display='none'; calendarView.style.display='block'; configView.style.display='none'; document.getElementById('pageTitle').textContent='Calendar'; renderCalendar(currentYear,currentMonth); renderMonths(); });
    navConfig.addEventListener('click', ()=>{ setActive(navConfig); homeView.style.display='none'; calendarView.style.display='none'; configView.style.display='block'; document.getElementById('pageTitle').textContent='Configurations'; });

    // Export & Import
    document.getElementById('exportBtn').addEventListener('click', ()=>{ const data=loadData(); const blob=new Blob([JSON.stringify(data, null, 2)], {type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='reading_sessions.json'; a.click(); URL.revokeObjectURL(url); });
    document.getElementById('importFile').addEventListener('change', (e)=>{ const f=e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=function(){ try{ const parsed=JSON.parse(r.result); saveData(parsed); renderHome(); renderCalendar(currentYear,currentMonth); renderMonths(); alert('Import successful'); }catch(err){ alert('Invalid JSON'); } }; r.readAsText(f); });

    // Utilities
    function sumSecondsForDate(data,y,m,d){ const key = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`; const arr = data[key]||[]; return arr.reduce((s,sess)=>s + (sess.secs||0),0) }
    function startOfWeek(d){ const dd=new Date(d); const day=dd.getDay(); const diff = dd.getDate() - day + (day===0?-6:1); dd.setDate(diff); dd.setHours(0,0,0,0); return dd }

    // Initialize
    function ensureDemo(){ if(!localStorage.getItem('demo_populated')){ const d={}; const today=new Date(); const key=today.toISOString().slice(0,10); d[key]=[
        {start:new Date(today.getFullYear(),today.getMonth(),today.getDate(),11,4).toISOString(), end:new Date(today.getFullYear(),today.getMonth(),today.getDate(),11,58).toISOString(), secs:53*60},
        {start:new Date(today.getFullYear(),today.getMonth(),today.getDate(),11,58).toISOString(), end:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,1).toISOString(), secs:2*60},
        {start:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,1).toISOString(), end:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,2).toISOString(), secs:1*60},
        {start:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,2).toISOString(), end:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,7).toISOString(), secs:4*60},
        {start:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,7).toISOString(), end:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,57).toISOString(), secs:50*60},
        {start:new Date(today.getFullYear(),today.getMonth(),today.getDate(),12,57).toISOString(), end:new Date(today.getFullYear(),today.getMonth(),today.getDate(),14,53).toISOString(), secs:1*60*60+56*60}
      ]; saveData(d); localStorage.setItem('demo_populated','1'); }
    }

    ensureDemo(); renderHome(); renderMonths(); renderCalendar(currentYear,currentMonth);

    // live clock
    setInterval(()=>{ document.getElementById('clock').textContent = new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}); }, 1000);

    // keyboard shortcuts for desktop testing
    document.addEventListener('keydown', (e)=>{ if(e.key===' ') { e.preventDefault(); startBtn.click(); } });
  </script></body>
</html>
